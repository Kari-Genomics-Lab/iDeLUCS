import pyximport 
pyximport.install()

from idelucs.kmers import kmer_counts, cgr
import numpy as np

test_seq = bytearray("AACAAACTTTTTTAACTCAACTCCCCTATTGAATGTACCCCCCCCTTCCCCCCCAGGGGGGGTATACTATGCATAATCGTGCATACATTTATATTCCACATATATTATGGTACCAGTACTATATACTATAATCGTACTAAACCCATTACATGTATACGGACATTACACCACAGCCCCATTCCTCCCAATGTACACTCCATGCACTGCCCCAAGACCAGAACCACTACTTCCCCTTCACCTGCTAACCAACCCTCAAGTCACCATACTATGAATGGTTACAGGACATACATGCAATACCAGGCACTTCCCCATTTGGTTATGCTCGACGTACCAGATGGATTTATTGATCGTACACCTCACGAGAGATCAGCAACCCCTGCCCGTAATGTACTTTATGACTAGCTTCAGGCCCATTCTTTCCCCCTACACCCCTCGCCCCTCTTGCTCTTTTGCGCCTCTGGTTCCTCGGTCAGGAACATCCCATGCTTAACTCCTGAACTTTCTCACTTTTCACGAAGTCATCTGTGCATTATTCTCCCCTATTTAGTCCGTGATCGCGGCATCTTCTTTCTTCATTGCTGTTGGTTCCTCTTTTTTCTGGGGCTTCTTCACAGGTTGCCCTTCACAGTGCAGGTGCGGAGTGCTATTCAAGTGAAGCCTGGACTACTCCTGCGTTGCGTCCTATTCTAGTACTCTCGTGTCCCTCAATGAGACGGTTTGCGTGTATGGGGAATCATTTTGACACTGATGCACTTTGGATCGCATTTGGTTATGGCTCTTCCACCCCCCCGCTAAATGGGGCTATTTAGTGAATGCTTGTCGGACATATTTTTACGAATTTTCACTTCCTCTATTTTCTCCACAAAACTAGGAGATTCACCACAATTTTTTCTTTAGTTTTTTGTTATTTTTTTTAAAAACATTTTTAAAAAACTAAATTAAACTAAAACTACCGCATAAAAACCCCCAAACCACAAAAACGTTTCGTTTAGTATATATACATTGTTACATTCACCATTTTTATTAGAGAAACTCCACTACTAAACTTTCTTTTCCAAAAACAAAAATTACATTGGACAAAACCCTACAAACAAACATTATTTATATTGATGACAAACAAATGGCTCAATTCTCCTACCTCCAACAGCCTCCATAGCTTAATCCAAAGCATGGCACTGAAGATGCCAAGACGGTACCTATAATACCTGTGGGCAAAAGACTTAGTCCTAACCTTGCTATTGATTTTTGCTAGACATATACATGCAAGTATCCGCACGCCAGTGAGAATGCCCTGACACCTCCAATAAGAATAAAGGAGCAGGTATCAGGCACACCCGAGAGTAGCCCAAGACACCTTGCCTTAGCCACGCCCCCACGGGTATTCAGCAGTAATTAACCTTAAGCAATAAGTGTAAACTTGACTTAGCCATAGCAATTCAGGGTTGGTAAATCTTGTGCCAGCCACCGCGGTCATACAAGAGACCCAAATCAATAGCCACCCGGCGTAAAGAGTGGCCAGATGTTATCCCACTGCCTAAGATCAAAATGCAACTAAGCTGTCATAAGCCCAAGATTCACTTAAGCCCCTTCAAACCATCTTAGCCCCACGACTAATTTTACCCCACGAAAGCCAGGGCACAAACTGGGATTAGATACCCCACTATGCCTGGCCCTAAATCTAGATGCTCAAATACCCATGCATCCGCCCGAGAACTACGAGCACAAACGCTTAAAACTCTAAGGACTTGGCGGTGCCCCAAACCCACCTAGAGGAGCCTGTTCTATAATCGATAGTCCACGATTCACCCAACCACCCCTTGCCAACACAGCCTACATACCGCCGTCGCCAGTCCACCTAAAATGAAAGATCAACAGTGGGCTCAATAGTCCACCACTAACAAGACAGGTCAAGGTATAGCCCATGGGGTGGAAGAAATGGGCTACATTTTCTACCATAGAATAAACGAAAGAGGACGTGAAACCCGTCCTTGGAAGGAGGATTTAGCAGTAAAGCAGGATCATACTCCCCTAAGCCTGCTTTAAGACGGCCCTGGGGCACGTACATACCGCCCGTCACCCTCTTCATAGGCCCCAATATTAATAAATAATACCTGCATCTAAGCCAAAGACGAGGCAAGTCGTAACAAGGTAAGCGTACCGGAAGGTGCGCTTAGACCACCGAGACGTAGCTATAAACCCCAAAGCATTCAGCTTACACCTGAAAGATATCTTCCAGAACAAGATCGTCTTGACTTGCCCTACCTCTAGCCCAACCATCACACTACCTCTCTTCATCAAAAACACATTTCCGCAGCAAACCAAAACATTCTAACCCTCTCTTAGTATAGGCGATAGAAAAGATTTCTGGCGCAATAGAGGTCTAACCGTACCGTAAGGGAAAGATGAAATAATAATGAAAACCAAAAGCAAAAAACAGTAAAGACCAACCCTTGTACCTCTTGCATCATGATTTAGCAAGAACAACCAAGCAAAGTGCACTAAAGTTTGCCCTCCCGAAACCCAAGCGAGCTACCTGAGAGCAGCTAAAATTGAGCAAACCCGTCTCTGTCGCAAAAGAGTGGGGCGACTCTCTGGTAGAGGTGAAAAGCCAACCGAGCTGGGTGATAGCTGGTTGCCTGCCAAATGAATCTAAGTTCCCCCTTAGTCTACTCTCTAAGGATATTCATCTAAACCCCACACATGTCAGGACTAAGAGCAACTCGACGGGGGTACAGCCCCTTCGAAAAAGAATACAATCTCCTCCAGCGGATAATACCCTTTTACCCCTTACCGTGGGCCTTAAAGCAGCCATCAACAAAAGAGTGCGTCAAAGCTCCCCCATCAAAAATCCAAAAACCAATTTGACTCCCTCACCCAAAGCAGGCCAACCTATGAAAATAGAAGGATTAATGCTAAAATGAGTAACTCGGAATTCTCCTCACAGCGCAAACTTACATCAACTTATTATTAACAGCCTAACTTATACCCAAACTCCAACAAGAACACGTATTCAACCTAACCTGTTACACCGACTCAGGAGCGCCCACATAGATGATTAAAATCTGCAAAAGGAACTCGGCAAGCCAAAGACCCGACTGTTTACCAAAAACATAGCCTTTAGCAAACAACAAGTATTAAAGGTGATGCCTGCCCAGTGACCCATAAAGTTTAACGGCCGCGGTATCCTAACCGTGCGAAGGTAGCGCAATCAATTGTCCCATAAATTGAGACTTGTATGAATGGCTAAACGAGGTCTTAACTGTCTCTTGCAGATCATCAGTGAAATTAGTATTCCCGTGCAAAAACGAGAATGTGACCATAAGACGAGAAGACCCTGTGGAACTTAAAAATAACAATCACCTCCTCACCAGCACCCCCCCCCCCCGGGGGGGCCTACCTGTATACAATACCTGATTGACATTTTTCGGTTGGGGCGACCTTGGAGAAAAACAAATCCTCCAAACCTGCAGACCATAACTCTTCACCAAGATTAACCCATCAAAGTACTAATAGTAACTTAGACCCAATATAATTGATCAATGAACCAAGCTACCCCAGGGATAACAGCGCAATCTCCTCCAAGAGCCCATATCGACAAGGAGGTTTACGACCTCGATGTTGGATCAGGACACCCTAATGGTGCAGCCGCTATTAAGGGTTCGTTTGTTCAACGATTAACAGTCCTACGTGATCTGAGTTCAGACCGGAGCAATCCAGGTCGGTTTCTATCTATGAATTAACTCCTCCTAGTACGAAAGGACCGGAGAAGTGGGGTCAATGCCATAAAGTACACCCCAGCTTATAAGCAATGAACTCAGCTCAATTGCCAAAAGCCCCACACACACCTAATTCCTAGAAAAGGAACAGCTAGCGTGGCAGAGCTCGGCAAATGCAAAAGGCTTAAGCCCTTTATCCAGAGGTTCAAATCCTCTCCCTAGCTCCTCCCCCAATATGACCTCATCCTCCCTAATAAGCCTCTTAGCCATAACCTTATCCTATGTACTCCCAATTCTAATCGCCGTGGCCTTCTTAACACTTGTAGAACGAAAAATCCTCAGCTACATACAGGCCCGAAAGGGCCCAAACATCGTGGGCCCTTTTGGTCTACTCCAGCCTGTCGCGGATGGAGTGAAATTGTTCATTAAAGAGCCCATCCGTCCATCCACCTCTTCCCCCTTCCTCTTCACCATAACACCTGTCCTAGCCCTCCTACTAGCCCTCACCATCTGGACGCCCCTCCCACTACCCTTCCCCCTTGCAGACCTGAACCTAGGCCTGCTATTCCTCCTGGCCATGTCAAGTCTAACTGTCTACTCCCTGCTCTGATCCGGATGAGCTTCAAACTCCAAATACGCCCTAATCGGAGCCCTTCGTGCTGTTGCTCAGACAATCTCATATGAAGTTACCCTGGCCATCATCCTTCTATCCACAATTATATTATGCGGGAACTACTCCTTAAGCACTCTAGCCACCACCCAAGAACCCATCTACCTTATTTTTCCCTCATGGCCTCTAGCAATAATATGATTTATTTCTACCCTCGCTGAGACTAACCGTGCCCCATTCGACCTCACAGAAGGAGAATCTGAACTTGTCTCAGGGTTCAACGTTGAATATGCCGCCGGACCATTTGCCCTGTTCTTCCTAGCAGAATACGCTAACATCATGTTAATAAACACGCTAACAACCATCCTATTCCTCAACCCTAGCTTTTTAAGCCTCCCATCCGAACTATTCTCCGTTGCACTAGCTACAAAAACCCTTCTACTCTCATCCTCATTCCTATGGATCCGAGCCTCATACCCACGATTCCGCTATGACCAACTAATGCACCTCCTATGAAAAAACTTCCTACCCCTAACCCTAGCCCTATGTCTATGACACACCAGCATACCAATTAGCTACGCCGGTCTACCCCCAATCTAAGGCAGCGTGCCTGAACATAAAGGATCACTATGATAAAGTGAACATAGAGGTACAATAATCCTCTCGCTTCCTTTTAACTTAGAAAAGTAGGAATCGAACCTACACAAAAGAGATCAAAACTCTTCATACTCCCCTTATATTATTTTCTAGTAGGGTCAGCTAACCAAGCTATCGGGCCCATACCCCGAAAATGATGGTCTAACCCCTTCCCCTACTAATGAACCCTCATGCAAAACTAGCCTTCACCGCAAGTTTACTGCTAGGAACCAGCATTACCATCTCTAGTAACCATTGAATCTTAGCTTGAGCCGGCCTAGAAATCAACACCTTAGCCATCATTCCCCTTATCTCCAAATCTCACCACCCTCGAGCAATTGAAGCAACCATCAAATACTTCCTTACCCAATCAGCCGCATCAGCCTTAATTCTGTTCTCAAGCTTAGCCAATGCCTGATCCACAGGCCAATGAGACATCACACAATTAAACCACCCCACATCCTGCCTAGTACTGACCATAGCAATCGCAATCAAATTAGGACTAGTCCCATTCCACTTCTGATTCCCGGAAGTACTTCAAGGCTCTTCAATAATTACCGCCCTACTACTCTCGACTCTCATAAAACTACCCCCAATCACCCTTCTCCTCATTACATCACAATCCCTTAACCCCCCACTACTCACCCTTCTAGCAATCTCCTCCGCACTAATCGGGGGCTGAATAGGCCTTAACCAGACACAGACACGAAAAATCCTAGCTTTCTCATCCATCTCACACCTAGGCTGAATAATCATTGTTATCACCTACAACCCCCATCTCACCCTCCTCACCTTTACCCTCTATACAGTAATAACAACAACCGTGTTCCTATCCCTCAATCAAATCAAAGTCCTAAAACTGTCAACAATACTCATCTCATGAACAAAAACACCCACACTAAACGCAGCCATAATACTAACACTCCTATCCTTAGCAGGCCTCCCGCCCCTAACAGGCTTCATGCCAAAATGATTCATCATCCAAGAGCTTACTAAGCAAGAAATAACCCCCACAGCCACAATTATCACCATGCTATCACTCTTAGGCCTATTTTTCTACCTCCGCCTCGCATACCATTCAACAATCACACTCCCACCCAACTCATCCAACCACATAAAACTCTGACGAACCAACAAAACACCAAACACCTCTACAGCCATCCTATCCGCCCTATCAACTTCCCTGCTACCTTTGTCTCCCCTAATTATCACCATATTCTAGAAACTTAGGATTAAACCGCCGCCTAAACCAAAGGCCTTCAAAGCCTTAAATAAGAGTTAAACTCTCTTAGTTTCTGCCATGCTAAGACTAACAGGGCATTAACCTGTATCTTCTGAATGCAAACCAGATGCTTTAATTAAGCTAAAGCCTTTATCTAGGCAGATGGGCCTCGATCCCATACAATTCTAGTTAACAGCTAGACGCCACAACCCCTTGGCTTCTGCCTACAAGACCCTGGCACGCTCTTGCGCACATCAATGAGCTTGCAACTCACCATGAACTTCACCACAGGGTCGATAAGAAGAGGAATCAAACCTCTGTAAAAAGGACTACAGCCTAACGCTTCAACACTCAGCCATCTTACCTGTGACCTTCATCAACCGATGATTATTCTCAACTAACCACAAAGATATCGGCACTCTTTATCTAATTTTCGGCACATGAGCAGGCATAGTCGGCACAGCACTTAGCCTGTTAATTCGCGCAGAACTGGGGCAACCAGGAACACTTTTGGGAGACGACCAAATTTACAATGTAATCGTCACAGCCCATGCCTTCGTTATAATTTTCTTCATAGTTATGCCAATCATAATCGGAGGCTTTGGGAACTGACTAGTTCCTCTCATAATTGGTGCCCCAGACATAGCATTCCCACGCATGAACAACATAAGCTTCTGACTTCTTCCTCCCTCTTTTCTTCTCCTACTAGCTTCCTCCACCGTAGAAGCTGGGGCCGGTACTGGATGAACTGTCTATCCCCCCTTAGCCGGAAATCTCGCCCATGCCGGTGCATCAGTAGACCTAGCCATCTTCTCCCTTCATCTCGCAGGTGTATCATCTATTTTAGGGGCTATTAACTTCATCACCACCATTATTAACATAAAACCCCCCGCACTGTCACAGTACCAAACACCCCTATTCGTTTGATCTGTCCTCATTACTGCTATTCTCCTACTACTTTCTCTACCTGTCCTAGCCGCCGGAATTACAATACTACTCACCGACCGCAACCTTAACACTACATTCTTCGACCCTGCAGGGGGAGGGGATCCAATCCTCTACCAACATCTGTTCTGATTCTTCGGCCACCCTGAAGTTTATATTCTCATCCTTCCGGGTTTCGGAATAATCTCTCATGTAGTAGCTTACTACGCAGGGAAAAAAGAACCATTTGGCTACATAGGAATAGTGTGAGCAATACTATCAATCGGATTCTTGGGCTTTATTGTATGGGCCCATCACATATTCACAGTGGGAATAGACGTGGACACCCGAGCTTACTTTACATCTGCCACTATGATCATCGCTATCCCAACCGGTATTAAGGTCTTTAGCTGACTCGCAACCTTACATGGAGGGACAATCAAATGAGATCCGCCCATGCTATGAGCCTTAGGATTCATCTTCTTATTTACTATCGGAGGCTTAACAGGAATTGTCCTAGCCAACTCATCGCTAGATATTGCCCTCCACGATACCTACTACGTAGTTGCCCACTTCCACTATGTTCTCTCAATAGGGGCAGTTTTCGCCATTCTAGCAGGATTCACTCACTGATTCCCCCTTTTCACAGGCTTCACTCTCCACCCCTCATGAACTAAAGCACACTTCGGAGTAATATTCACAGGAGTAAACCTAACTTTCTTCCCACAACACTTCCTAGGCCTAGCTGGCATGCCCCGACGATACTCAGACTATCCGGACGCCTACACATTATGAAACACATTATCCTCAATCGGCTCCCTAATCTCAATAACAGCTGTAATCATGCTCATATTCATCGTCTGAGAAGCTTTCTCAGCAAAGCGAAAAGTACTTCAGCCCGAATTAACTTCCACTAACATCGAATGAATCCACGGCTGCCCCCCTCCATACCACACCTTCGAGGAACCAGCCTTTGTCCAAGTACAAGAAAGGAAGGAATCGAACCCTCACATGCTGGTTTCAAGCCAACCGCATCAAACCAATTAATGCTTCTTTCTCATGAGCTGTTAGTAAACCAATTACATAGACTTGTCAAGGCTAAATCACAGGTGCAAACCCTGTACACCTCACATGGCAAACCACTCCCAACTAGGATTTCAAGATGCCTCATCCCCCATCATAGAAGAACTTGTTGAATTCCACGACCACGCCCTAATAGTAGCATTGGCGATCTGTAGCCTAGTCCTCTACCTTCTTACCCTTATACTCATAGGAAAACTATCATCAAATACTGTAGACGCCCAAGAAATCGAATTAATCTGAACTATCCTTCCTGCCGTTGTCCTAGTCCTACTTGCCCTCCCCTCCCTGCAAATCCTCTACATAATAGATGAAATTGATGAACCCGATCTTACCCTAAAAGCCATCGGCCACCAATGATACTGAACTTATGAGTACACTGACTTCAAAGATCTTTCATTCGACTCTTACATAACCCCAACAACAGACCTCCCCCAAGGCCACTTCCGCCTCCTAGAAGTCGACCACCGCATTGTAGTCCCAATAGAGTCACCCATCCGAATAATCATTACCGCTGACGATGTACTTCACTCATGAGCCGTCCCAACCCTCGGGGTAAAAACAGACGCAATTCCAGGACGATTAAATCAAACTTCCTTCATTACCACTCGGCCAGGAGTGTTTTACGGACAATGCTCAGAAATCTGCGGAGCTAACCACAGTTTCATGCCCATCGTAGTAGAATCTACCCCTCTCAAACATTTTGAAGCCTGAACTTCTCTTTTATCATCCTAACCATTAAGAAGCTATGAACCAGCACTAGCCTTTTAAGCTAGAGAAAGAGGAGATTTCCCCCTCCTTAATGGTATGCCTCAGCTAAACCCCAACCCATGATTCATTACCATAATCCTAACCTGATTCACCTTCTCCCTACTTATTCAACCCAAACTACTATCGTTTATCCCCACAAATAACCCCACAAACAAAACCATAACAACAAAACCCACCCCCTGAACTTGACCATGAACCTAAGCTTCTTCGACCAATTTTCAAGCCCATACCTCCTAGGCATGCCACTAATCCTCCCATCCCTTCTTCTCCCGACCCTCCTACTCCCATCACCGGGACGCCGGTGGGTCAATAACCGTCTTTCTACCATTCAACTCTGGTTTATTCACCTAATTACGAAACAACTAATAACCCCCCTAAACAAAGCAGGTCACAAATGAGCCCTTCTCCTAATTTCCCTTATCTTAATACTCCTCTCCATCAACCTACTTGGCCTCCTCCCATACACCTTTACCCCCACCACCCAATTATCGATAAACATAGCCCTAGCCTTTCCCCTATGACTTGCCACTTTGCTAATCGGATTACGAAATCAACCCTCCGCATCCCTAGGCCACCTCCTCCCTGAGGGAACACCCACCCCATTAATTCCAGCCCTAATCATAATCGAAACAACCAGCCTTCTCATCCGACCTTTAGCCCTAGGAGTACGCCTGACAGCTAACCTCACAGCTGGCCATTTACTTATCCAACTCATCTCCACAGCCACAATTACCCTCTTACCAATAATACCATCAATCTCTCTCCTAACAGCAATCATCCTCTTTCTACTGACCATCCTAGAAGTAGCAGTAGCTATGATCCAAGCCTATGTCTTTGTTCTCCTACTAAGCCTATACTTACAAGAAAATATCTAATGGCACACCAAGCACATTCCTACCACATAGTCGACCCAAGCCCATGACCAATCTTCGGCGCAGCCGCAGCACTACTAACCACCTCAGGCTTAATCATGTGATTCCACTTCAACTCATCAGCCCTGCTATCAATAGGCCTTCTTTCTATACTTCTAGTTATACTGCAATGATGACGGGATGTAGTTCGAGAAAGCACCTTCCAAGGCCACCACACCCCAACTGTCCAAAAAGGCCTACGATACGGCATGATCCTCTTCATTACATCAGAAGCCTTCTTCTTCCTAGGCTTCTTCTGAGCCTTCTTCCACTCAAGCCTAGCCCCCACACCAGAACTAGGGGGACAATGACCCCCTACAGGAATTAGCCCCCTAAACCCCCTCGAAGTCCCCCTTCTAAACACAGCAATCCTCCTAGCCTCCGGCGTTACCGTGACATGAGCCCACCATAGCATTACCGAAGGAAACCGAAAACAAGCCATCCACGCACTAACCCTCACCATTATCCTAGGATTCTACTTCACTGCCCTACAGGCAATAGAATATCATGAAGCTTCATTTTCAATCGCTGATAGCGTTTATGGCTCCACTTTCTTCGTCGCCACAGGATTCCATGGGCTACACGTAATCATCGGATCGTCCTTCCTATCAGTCTGTCTTCTACGACTAATCAAATTCCACTTTACATCAAATCATCATTTCGGATTTGAAGCAGCAGCCTGATACTGACACTTCGTAGACATTATCTGACTCTTCCTCTATATATCAATATACTGATGAGGATCCTGCTCTTCTAGTATACTCATTACAATTGACTTCCAATCTTTAAAATCTGGCGCAAATCCAGAGAAGAGCAATGAATTCACTCACATTCATACTATCATCATCTTTTCTACTAAGCACTGCACTAACCACCCTGAACTTCTGACTCGCCCAAATAACCCCAGACACAGAAAAACTATCCCCATATGAATGTGGATTTGACCCCCTAGGATCCGCCCGACTCCCATTCTCAATCCGATTCTTCCTCAGTAGCCATCCTATTCCTTCTATTCGACCTAGAAATCGCCCTACTCCTCCCCCTCCCATGAGCCATTCAACTTCAATCACCCACTACAACCCTCACCTGAGCTACCACTATCATTACCCTCCTCACACTTGGCCTCATTTACGAGTGGATGCAAGGAGGCCTAGAATGAGCAGAATAACAGAAAGCTAGTCTAACTAAGACAGCTGGTTTCGGCCCAGCAAATTATAGATACCATCTATAGCTTTCTTATGTCTCCCCTTCACTTTAGCTTCTACTCTGCATTCACATTCAGCTGCCTAGGATTAGCATTCCACCGAACCCACCTTATCTCCGCCCTTCTTTGCTTGGAAAGCATAATACTATCCATATTCATCCCCCTCTCAATATGGCCCATCGAGAACCAGACCCCATCATTCACCCTCGTACCCATCCTCATACTAGCTTTCTCAGCATGCGAAGCTGGTGCCGGCCTAGCTATACTAGTAGCTTCAACCCGAACACATGGTTCCGACCACCTACACAACCTAAACCTCCTACAATGCTAAAAATCATCCTACCAACAACTATACTCCTACCAATAACCCTGCTATCCCCAGCAAAATCCATATGAACTAACACCACAGCCCACAGCCTCCTAATCGCCCTAATTAGCCTACACTGACTGGTCCCATCATACTACCCCTCAAAAAACTTAGCCCATTGAGCAGGTATTGACCAAATCTCAGCACCTCTGCTAGTCCTCTCCTGCTGATTCCTCCCGCTCATAATCTTGGCCAGCCAAGGCCATTTGCAATACGAACCCCATGTACGAAAACAAATATTCATCTCTACCCTCGTCATCATCCAACCATTTATCATCCTGGCCTTTTCAGCAACAGAACTCATACTATTCTACATCTCATTCGAAGCAACCCTAATCCCAACCCTAATCTTAATTACACGCTGAGGAAACCAACCCGAACGACTCAGCGCAGGCATTTACCTCCTCTTCTACACCTTAATTAGCTCCCTACCACTACTAATCTCCATCCTCTACCTTCACTCAAAAACAGGGACACTCCACCTTCCTGTCCTCAAACTCACCCACCCAAATCCATCAACCCCATGAACAGGCTTGTTATCAAGCCTAGCCCTCCTAATAGCATTTATAGTCAAGGCCCCCCTATATGGCTTGCACCTATGACTGCCTAAAGCCCACGTAGAGGCACCAATTGCAGGCTCAATACTGCTCGCTGCCCTACTACTTAAGCTAGGGGGGTATGGCATCATACGAGCCACCCTACTAATTGAACCCCCATCCAACCACCTACACTACCCCTTCTTAACCTTGGCCTTGTGGGGCGCCTTAATAACTAGTTCCATCTGTCTACGTCAAACTGACCTAAAATCCCTCATCGCCTACTCATCCGTAAGCCACATAGGCCTGGTAATTGCCGCAGGCATAATCCAAACTCAATGATCGTTTTCAGGAGCAATAATCCTCATAATCTCCCATGGACTAACATCCTCCCTTCTATTCTGCCTAGCGAACACAAACTACGAACGAACACACAGCCGCATTCTCATCCTCACACGAGGCCTACAACCCCTCCTACCATTAATGTCAACATGATGGCTCCTAGCCAACCTAACTAACATAGCCCTACCCCCAACAACCAATTTAATAGCAGAATTAACAATCATAGTCGCCCTCTTTAACTGATCACCCCTTACAATCATCCTGACCGGAATCGCAACACTCTTAACCGCTTGCTACACCTTATACATACTACTGTCCACCCAGCGAGGAACCCTACCAACCCACATCACAACAGCCTCAAACTCAAACACACGAGAGCACCTCCTAATAACCCTCCACATCATCCCAATATTAGCCCTCATTCTTAAACCAGAGTTAATCTCAGCAACCCCTCTATGCAAACATAGTTTAATTCAAACATTAGATTGTGATTCTAAAAATAGGAGCTCAAACCTTCTTGTTCGCCGAGGGGAGGCTAAGCCAGCAAGAACTGCTAATTCCTGCATCCGAGCTTTAAACCTCGGCCCCCTTAACTTTTAAAGGATAAAAGTAATCCATTGGTCTTAGGAACCACCCATCTTGGTGCAATTCCAAGTAAAAGTAGTGGAAACAGTACTACTCCTAAACACTTTTACACTACTAACCCTATTTATCCTCCTCACCCCAATCATCCTATCCCCCCTACTTAATCTCAAAAACCCCCCACAATCAATCCCCCAAACCATTAAAACTGCCTTCCTAATCAGCCTCATTCCAACAACCATCTTCCTCCACTCAGGCATAGAAAGCATCACCACCTACTGAGAATGGCAACTCACCCAAAACTTCAAAATCCCAATCTCCTTAAAAATAGACCTATATTCCATAGTATTCTTCCCCATTGCACTGTTTGTAACCTGATCTATCCTAGAATTTTCGACATGGTACATAGCCTCCGAACCCTTTATCATAAAATTCTTCACCTTTCTCCTTATTTTCCTCATCGCCATATTAACCCTCACAATCGCAAACAACATATTCCTTCTATTTATCGGCTGAGAGGGAGTAGGAATCATATCGTTCCTCCTCATCGGCTGATGACAAGGACGGGCCGAAGCCAACACAGCTGCACTCCAGGCCATAATCTACAATCGAATCGGAGACATCGGCCTAATCCTAAGCATAGCATGACTAGCCTCAACACTAAACACCTGAGAAATTCAACAAGCCATTCAACCAAACCAAACGCCTACCCTCCCTCTTTTAGGACTAATCCTAGCCGCTACAGGAAAATCAGCCCAATTCGGCCTCCACCCATGACTCCCTGCAGCAATAGAGGGCCCAACTCCAGTCTCCGCCCTACTCCACTCCAGCACCATAGTAGTGGCCGGAATCTTCTTACTCATTCGCACTCACCCTATCTTAACCTCAAATAAACTAGCCCTAACCTCATGCCTATGCCTAGGCGCCCTATCAACATTATTCGCTGCCACCTGCGCCCTCACCCAAAATGACATCAAAAAAATCATTGCCTTCTCTACCTCAAGCCAACTAGGCCTCATAATAGTTACAATCGGACTAGATCTCCCCCAACTTGCTTTCCTCCACATCTCAACTCACGCATTCTTCAAAGCCATACTATTCCTATGTTCTGGCCTAATCATCCACAGCCTAAATGGAGAACAAGACATTCGCAAAATGGGATGCCTACAAAAAACCCTCCCAATAACCACCTCCTGCCTAACCATCGGCAACCTCGCCCTAATAGGCACTCCATTCCTAGCGGGCTTCTACTCAAAAGACCTAATCATTGAAAACCTAAACACCTCATACATTAACACCTGGGCCCTTCTCCTTACACTACTTGCCACATCCTTCACCGCAACTTACAGCCTCCGCATGACTCTCCTAGTCCAAACAGGACACACCCGAACCCCCACAATCACACCCATCAATGAAAACACATCCTCAGCCATCCTACCTATCATTCGACTAGCTTTCGGCAGCATCACAGCCGGCTTATTAATCTCATCACTCACCCTTCCCATGAAAACACCCCCAATAACCATACCTACTATTACAAAAACTGCTGCCATTGCCGTCACAGCCCTTGGGATCATCCTCGCCCTAGAACTCTCAAACATAACACACACCCTCACCCTCCCAAAACAAAGCCCTCTTACAAATTTCTCCTCTTCACTAGGCTACTTCAACCCCCTAATACATCGAACTAACCCTGCAATCCTCCTAAATACCGGACAAAAAATTGCCTCCCACTTAATCGACATAACATGGTACAAAAAAATAGGCCCTGAAGGCCTTGCCAACCTCCATCTCATCATAAGTAAAACCTCCACGACCCTTCATACAGGTCTAATCAAATCCTACCTAGGATCCTTCGCCCTAACAATCCTCACAACAATCCTACTAACCCAAAAATAAAGTTTAATGGCACCCAACATCCGAAAATCACACCCCCTACTAAAAATAATCAATAACTCCCTAATCGACCTGCCCGCCCCATCCAACATCTCCGCTTGATGGAACTTCGGCTCCCTGTTAGCAGTATGCCTCGCTACTCAAATCCTCACCGGCCTCCTACTGGCCATACATTATACCGCAGATACTTCCCTAGCTTTCTCCTCCGTAGCCCACACATGCCGAAACGTACAGTACGGCTGACTCATCCGAAACCTTCATGCAAATGGCGCCTCATTCTTCTTCATTTGCATCTTCCTTCACATCGGACGCGGCCTCTACTACGGCTCCTACCTATACAAAGAGACATGAAACACCGGAGTTATCCTACTCCTCACCCTCATAGCAACCGCTTTTGTAGGGTACGTCCTCCCATGAGGACAAATATCATTTTGAGGGGCTACCGTCATCACAAATCTATTCTCAGCAATCCCTTACATCGGACAAACCCTAGTGGAGTGGGCCTGAGGAGGATTCTCAGTTGACAACCCAACCCTCACCCGATTCTTCGCCCTACACTTCCTCCTCCCCTTCGTAATTGCAGGAATTACTATCACCCACCTCATATTCCTACACGAATCAGGCTCAAACAACCCACTAGGCATCTCATCTAATTCCGACAAAATCCCATTCCACCCATACTACTCCCTCAAAGACATCCTAGGCCTAGCACTTATATTCACCCCATTCCTAATACTAGCCCTATTCTCACCTAACCTTCTGGGCGACCCAGAAAACTTCACCCCAGCAAACCCACTAGTAACCCCACCTCACATTAAACCAGAATGATACTTCCTATTTGCCTATGCTATCCTACGCTCAATCCCAAATAAACTCGGAGGCGTCCTAGCACTAGCAGCCTCGGTACTCATCCTCCTCCTCATTCCCTTCCTTCACAAATCCAAACAACGAACTATAACCTTCCGCCCACTTTCCCAGGCCCTATTTTGATTGCTAGTTGCCAACCTTCTCATCTTAACTTGAGTAGGAAGCCAACCAGTAGAGCACCCATTCATCATCATCGGCCAAATAGCATCATTCTCATACTTCACCATCCTACTAATCCTCTTCCCCGCAGTCGGAACCCTAGAAAACAAAATACTTAACTACTAGTACTCTAATAGTTTATGAAAAACATTGGTCTTGTAAACCAAAAACTGAAGACTACACCCTTCTTAGAGTAACTCAGAAAAAAAGGACTTAAACCTTTCTCTCCAGCTCCCAAAGCTGGTATTTTAAATAAACTATTCTCTGAAACCCCTAAACCGCCCGAATCGCCCCCCGAGACAACCCACGTACAAGCTCCAGCACAACAAACAACACCAACAACAAACCTCACCCCGCCACTAAAAACAACCCAGCCCCACATGAATAAAACACCGCCACCCCACTGAAATCCAACCGAACTAAAGATATCCCCCCACTATCAACAGTAACCACTACAACCTTCCAAAAATCAACAAATCCTGCCAAAAACGCCCCAACACAAACCACCAAAACAAACCCCAACCCATAACCAGCTACCCGCCAATCTCCCCAAGCCTCAGGATATGGATCTGCCGCCAAAGACACAGAGTAAACAAAAACTACCAGCATACCCCCCAAATAGACCATAAACAATGCCAAAGAAATAAAAGAAACGCCTAAGCTCACTAACCACCCGCACCCAACTACAGATGCTAGCACTAACCCCACCACACCATAATAAGGAGAGGGGTTAGATGCTACAGCTAAAACCCCTAATATAAAACAGACCCCAAGAAAAATCACGAAATAAGTCATATGTTCCCGCTTGGATAGACCCCAAGGACTACGGCTTGAAAAGCCATTGTTGTTCTCAACTACGGGAAC", "utf-8")

def pos_gen(kmer):
    """
    Find the position of a particular kmer in the CGR.
    :param kmer: string with the kmer.
    :return: position in the CGR.
    """
    k = len(kmer)
    posx = 2 ** k
    posy = 2 ** k
    for i in range(1, k + 1):
        bp = kmer[-i]
        # print(posx, posy)
        if bp == 'C':
            posx = posx - 2 ** (k - i)
            posy = posy - 2 ** (k - i)
        elif bp == 'A':
            posx = posx - 2 ** (k - i)
        elif bp == 'G':
            posy = posy - 2 ** (k - i)
    return int(posx - 1), int(posy - 1)

def cgr_gen(probs, k):
    """
    Generate CGR from the kmer counts for a given value of k.
    :param probs: array with the normalized kmer counts
    :param k:
    :return: 2D - CGR pattern.
    """
    from itertools import product
    kamers = product(*(["ACTG"] * k))
    mat = np.zeros((2 ** k, 2 ** k))
    for i, kmer in enumerate(kamers):
        x, y = pos_gen(kmer)
        # print(x, y)
        mat[y][x] = probs[i]
    return mat

k = 4

def method1(test_seq: bytearray) -> np.array:
    counts = np.ones(4**k, dtype=np.int32)
    cgr(test_seq, k, counts)
    # counts = counts.reshape((2**k, 2**k))
    return counts

def method2(test_seq: bytearray) -> np.array:
    counts = np.ones(4**k, dtype=np.int32)
    kmer_counts(test_seq, k, counts)
    res = cgr_gen(counts, k)
    return res

result1 = method1(test_seq)
result2 = method2(test_seq)

result2 = result2 / np.sum(result2)
result2 = (result2 - np.mean(result2)) / np.std(result2)
print(result1 / np.sum(result1))
print(result2)
